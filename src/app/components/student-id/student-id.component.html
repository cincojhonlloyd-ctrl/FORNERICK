<div class="flex h-screen bg-slate-100 font-sans overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-64 bg-slate-900 border-r border-slate-800 hidden md:flex flex-col">
        <div class="p-6 flex items-center gap-3">
            <div class="w-8 h-8 rounded-lg bg-sky-500 flex items-center justify-center text-white font-bold">L</div>
            <h2 class="text-white font-bold text-lg tracking-wide">Library<span class="text-sky-500">.io</span></h2>
        </div>

        <nav class="flex-1 px-4 space-y-2 mt-4">
            <a routerLink="/admin"
                class="flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                </svg>
                <span>Dashboard</span>
            </a>
            <a routerLink="/generate-id"
                class="flex items-center gap-3 px-4 py-3 bg-slate-800 text-white rounded-xl transition-all shadow-lg shadow-slate-900/50">
                <svg class="w-5 h-5 text-sky-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
                <span class="font-medium">Student Mgmt</span>
            </a>
            <a
                class="flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-slate-800/50 rounded-xl transition-all cursor-pointer">
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
                <span>Reports</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col min-w-0 overflow-hidden">

        <!-- Top Header -->
        <header class="h-16 bg-white border-b border-slate-200 flex items-center justify-between px-8">
            <h1 class="text-xl font-bold text-slate-800">Student ID Management</h1>
            <div class="text-sm text-slate-500">Manage students and issue cards</div>
        </header>

        <div class="flex-1 overflow-y-auto p-8">

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Registration Form -->
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <h3 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                        <span
                            class="w-8 h-8 rounded-full bg-sky-100 text-sky-600 flex items-center justify-center">1</span>
                        Register New Student
                    </h3>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Full Name</label>
                            <input type="text" [(ngModel)]="studentName" placeholder="e.g. Jane Smith"
                                class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-sky-500 focus:ring-2 focus:ring-sky-200 outline-none transition-all text-slate-900">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Student ID #</label>
                            <input type="text" [(ngModel)]="studentId" (input)="validateNumberInput($event)"
                                placeholder="e.g. 2024005"
                                class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-sky-500 focus:ring-2 focus:ring-sky-200 outline-none transition-all text-slate-900">
                        </div>

                        <div *ngIf="successMessage"
                            class="p-3 bg-emerald-50 text-emerald-600 rounded-lg text-sm font-medium flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                            {{ successMessage }}
                        </div>

                        <button (click)="onRegister()" [disabled]="!studentName || !studentId || isSubmitting"
                            class="w-full py-3 bg-slate-900 text-white rounded-xl font-medium hover:bg-slate-800 disabled:opacity-50 transition-all flex justify-center items-center gap-2">
                            <span *ngIf="isSubmitting"
                                class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></span>
                            {{ isSubmitting ? 'Registering...' : 'Register & Generate ID' }}
                        </button>
                    </div>
                </div>

                <!-- ID Card Preview -->
                <div
                    class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col items-center justify-center relative bg-grid-pattern">
                    <h3 class="text-lg font-bold text-slate-800 mb-8 absolute top-6 left-6 flex items-center gap-2">
                        <span
                            class="w-8 h-8 rounded-full bg-sky-100 text-sky-600 flex items-center justify-center">2</span>
                        ID Card Preview
                    </h3>

                    <div class="relative group mt-8">
                        <!-- Canvas Container with Card Style -->
                        <div
                            class="bg-white p-4 rounded-xl shadow-xl border border-slate-200 w-[240px] flex flex-col items-center">
                            <div class="w-full flex items-center justify-between mb-4 border-b border-slate-100 pb-2">
                                <span class="text-xs font-bold text-sky-600">LIBRARY ACCESS</span>
                                <div class="w-4 h-4 bg-sky-500 rounded-full opacity-50"></div>
                            </div>

                            <canvas #qrCanvas class="mb-4"></canvas>

                            <div class="text-center w-full">
                                <p class="font-bold text-slate-800 text-lg leading-none">{{ studentName || 'Student
                                    Name' }}</p>
                                <p class="text-slate-400 font-mono text-sm mt-1">{{ studentId || 'ID: 000000' }}</p>
                            </div>
                        </div>
                    </div>

                    <button *ngIf="qrValue" (click)="downloadCard()"
                        class="mt-8 px-6 py-2 bg-sky-500 text-white rounded-full font-medium shadow-lg shadow-sky-500/30 hover:bg-sky-600 transition-all flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download ID Card
                    </button>
                </div>
            </div>

            <!-- Registered Students Table -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                <div class="p-6 border-b border-slate-100">
                    <h3 class="text-slate-800 font-bold">Registered Students Directory</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead>
                            <tr class="bg-slate-50 text-slate-500 text-xs uppercase font-semibold">
                                <th class="px-6 py-4">ID</th>
                                <th class="px-6 py-4">Name</th>
                                <th class="px-6 py-4">Registration Date</th>
                                <th class="px-6 py-4 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100">
                            <tr *ngFor="let student of students" class="hover:bg-slate-50 transition-colors">
                                <td class="px-6 py-4 font-mono text-slate-600 text-sm">{{ student.studentId }}</td>
                                <td class="px-6 py-4 font-medium text-slate-800">{{ student.fullName }}</td>
                                <td class="px-6 py-4 text-slate-500 text-sm">{{ student.registeredAt | date:'mediumDate'
                                    }}</td>
                                <td class="px-6 py-4 text-right">
                                    <button (click)="viewQR(student)"
                                        class="text-sky-500 hover:text-sky-700 font-medium text-sm">View ID</button>
                                </td>
                            </tr>
                            <tr *ngIf="students.length === 0">
                                <td colspan="4" class="px-6 py-8 text-center text-slate-400">No students registered yet.
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </main>
</div>